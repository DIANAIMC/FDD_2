#! /bin/bash

#giving m users
read -p "enter number of users: " num_users
m="${num_users:-1000}"
while [[ $m -lt 1 || $m -gt 10000 ]]
do
read -p "number out of interval [1-10000], try again: " num_users
m="${num_users:-1000}"
done


#droping table users
psql -d fdd -c "drop table if exists users"

#creating table random users
psql -d fdd -c "create table if not exists users(user_id serial primary key, name varchar(25));"

#filling table users
for ((i = 1; i <= $m; i++)); do letters=$(for letter in {a..z}; do echo $letter; done | tr '\n' ' '); query=$(echo $i | awk -v letters="$letters" -v v_index="$i" "BEGIN {srand(v_index)}; {split(letters, list_letters); for(i = 0; i < 5 + (rand()*100 % 10); i++) r_word = r_word list_letters[int(rand()*length(list_letters)) + 1]; printf(\"%s\", r_word)}");  psql -d fdd -c "insert into users(name) values ('$query')"; done
